(this["webpackJsonpweb-app"]=this["webpackJsonpweb-app"]||[]).push([[0],{176:function(e,t,n){e.exports=n(364)},181:function(e,t,n){},195:function(e,t){},196:function(e,t){},197:function(e,t){},198:function(e,t){},199:function(e,t){},200:function(e,t){},201:function(e,t,n){"use strict";(function(e,t){var i=n(16),a=n.n(i),r=n(39),o=n(7),s=n(8),c=n(10);!function(){if("undefined"!==typeof e);else if("undefined"!==typeof window)window.global=window;else{if("undefined"===typeof self)throw new Error("cannot export Go (neither global, window nor self is defined)");self.global=self}var i=e.process&&"node"===e.process.title;if(i){e.require=n(202),e.fs=n(203);var l=n(204);e.crypto={getRandomValues:function(e){l.randomFillSync(e)}},e.performance={now:function(){var e=t.hrtime(),n=Object(c.a)(e,2);return 1e3*n[0]+n[1]/1e6}};var u=n(302);e.TextEncoder=u.TextEncoder,e.TextDecoder=u.TextDecoder}else{var h="";e.fs={constants:{O_WRONLY:-1,O_RDWR:-1,O_CREAT:-1,O_TRUNC:-1,O_APPEND:-1,O_EXCL:-1},writeSync:function(e,t){var n=(h+=f.decode(t)).lastIndexOf("\n");return-1!=n&&(console.log(h.substr(0,n)),h=h.substr(n+1)),t.length},write:function(e,t,n,i,a,r){if(0!==n||i!==t.length||null!==a)throw new Error("not implemented");r(null,this.writeSync(e,t))},open:function(e,t,n,i){var a=new Error("not implemented");a.code="ENOSYS",i(a)},read:function(e,t,n,i,a,r){var o=new Error("not implemented");o.code="ENOSYS",r(o)},fsync:function(e,t){t(null)}}}var d=new TextEncoder("utf-8"),f=new TextDecoder("utf-8");if(e.Go=function(){function t(){var e=this;Object(o.a)(this,t),this.argv=["js"],this.env={},this.exit=function(e){0!==e&&console.warn("exit code:",e)},this._exitPromise=new Promise((function(t){e._resolveExitPromise=t})),this._pendingEvent=null,this._scheduledTimeouts=new Map,this._nextCallbackTimeoutID=1;var n=function(){return new DataView(e._inst.exports.mem.buffer)},i=function(e,t){n().setUint32(e+0,t,!0),n().setUint32(e+4,Math.floor(t/4294967296),!0)},a=function(e){return n().getUint32(e+0,!0)+4294967296*n().getInt32(e+4,!0)},r=function(t){var i=n().getFloat64(t,!0);if(0!==i){if(!isNaN(i))return i;var a=n().getUint32(t,!0);return e._values[a]}},s=function(t,i){if("number"===typeof i)return isNaN(i)?(n().setUint32(t+4,2146959360,!0),void n().setUint32(t,0,!0)):0===i?(n().setUint32(t+4,2146959360,!0),void n().setUint32(t,1,!0)):void n().setFloat64(t,i,!0);switch(i){case void 0:return void n().setFloat64(t,0,!0);case null:return n().setUint32(t+4,2146959360,!0),void n().setUint32(t,2,!0);case!0:return n().setUint32(t+4,2146959360,!0),void n().setUint32(t,3,!0);case!1:return n().setUint32(t+4,2146959360,!0),void n().setUint32(t,4,!0)}var a=e._refs.get(i);void 0===a&&(a=e._values.length,e._values.push(i),e._refs.set(i,a));var r=0;switch(typeof i){case"string":r=1;break;case"symbol":r=2;break;case"function":r=3}n().setUint32(t+4,2146959360|r,!0),n().setUint32(t,a,!0)},c=function(t){var n=a(t+0),i=a(t+8);return new Uint8Array(e._inst.exports.mem.buffer,n,i)},l=function(e){for(var t=a(e+0),n=a(e+8),i=new Array(n),o=0;o<n;o++)i[o]=r(t+8*o);return i},u=function(t){var n=a(t+0),i=a(t+8);return f.decode(new DataView(e._inst.exports.mem.buffer,n,i))},h=Date.now()-performance.now();this.importObject={go:{"runtime.wasmExit":function(t){var i=n().getInt32(t+8,!0);e.exited=!0,delete e._inst,delete e._values,delete e._refs,e.exit(i)},"runtime.wasmWrite":function(t){var i=a(t+8),r=a(t+16),o=n().getInt32(t+24,!0);fs.writeSync(i,new Uint8Array(e._inst.exports.mem.buffer,r,o))},"runtime.nanotime":function(e){i(e+8,1e6*(h+performance.now()))},"runtime.walltime":function(e){var t=(new Date).getTime();i(e+8,t/1e3),n().setInt32(e+16,t%1e3*1e6,!0)},"runtime.scheduleTimeoutEvent":function(t){var i=e._nextCallbackTimeoutID;e._nextCallbackTimeoutID++,e._scheduledTimeouts.set(i,setTimeout((function(){e._resume()}),a(t+8)+1)),n().setInt32(t+16,i,!0)},"runtime.clearTimeoutEvent":function(t){var i=n().getInt32(t+8,!0);clearTimeout(e._scheduledTimeouts.get(i)),e._scheduledTimeouts.delete(i)},"runtime.getRandomData":function(e){crypto.getRandomValues(c(e+8))},"syscall/js.stringVal":function(e){s(e+24,u(e+8))},"syscall/js.valueGet":function(t){var n=Reflect.get(r(t+8),u(t+16));t=e._inst.exports.getsp(),s(t+32,n)},"syscall/js.valueSet":function(e){Reflect.set(r(e+8),u(e+16),r(e+32))},"syscall/js.valueIndex":function(e){s(e+24,Reflect.get(r(e+8),a(e+16)))},"syscall/js.valueSetIndex":function(e){Reflect.set(r(e+8),a(e+16),r(e+24))},"syscall/js.valueCall":function(t){try{var i=r(t+8),a=Reflect.get(i,u(t+16)),o=l(t+32),c=Reflect.apply(a,i,o);t=e._inst.exports.getsp(),s(t+56,c),n().setUint8(t+64,1)}catch(h){s(t+56,h),n().setUint8(t+64,0)}},"syscall/js.valueInvoke":function(t){try{var i=r(t+8),a=l(t+16),o=Reflect.apply(i,void 0,a);t=e._inst.exports.getsp(),s(t+40,o),n().setUint8(t+48,1)}catch(c){s(t+40,c),n().setUint8(t+48,0)}},"syscall/js.valueNew":function(t){try{var i=r(t+8),a=l(t+16),o=Reflect.construct(i,a);t=e._inst.exports.getsp(),s(t+40,o),n().setUint8(t+48,1)}catch(c){s(t+40,c),n().setUint8(t+48,0)}},"syscall/js.valueLength":function(e){i(e+16,parseInt(r(e+8).length))},"syscall/js.valuePrepareString":function(e){var t=d.encode(String(r(e+8)));s(e+16,t),i(e+24,t.length)},"syscall/js.valueLoadString":function(e){var t=r(e+8);c(e+16).set(t)},"syscall/js.valueInstanceOf":function(e){n().setUint8(e+24,r(e+8)instanceof r(e+16))},debug:function(e){console.log(e)}}}}return Object(s.a)(t,[{key:"run",value:function(){var t=Object(r.a)(a.a.mark((function t(n){var i,r,o,s,c,l,u,h=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._inst=n,this._values=[NaN,0,null,!0,!1,e,this._inst.exports.mem,this],this._refs=new Map,this.exited=!1,i=new DataView(this._inst.exports.mem.buffer),r=4096,o=function(e){var t=r;return new Uint8Array(i.buffer,r,e.length+1).set(d.encode(e+"\0")),r+=e.length+(8-e.length%8),t},s=this.argv.length,c=[],this.argv.forEach((function(e){c.push(o(e))})),l=Object.keys(this.env).sort(),c.push(l.length),l.forEach((function(e){c.push(o("".concat(e,"=").concat(h.env[e])))})),u=r,c.forEach((function(e){i.setUint32(r,e,!0),i.setUint32(r+4,0,!0),r+=8})),this._inst.exports.run(s,u),this.exited&&this._resolveExitPromise(),t.next=19,this._exitPromise;case 19:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"_resume",value:function(){if(this.exited)throw new Error("Go program has already exited");this._inst.exports.resume(),this.exited&&this._resolveExitPromise()}},{key:"_makeFuncWrapper",value:function(e){var t=this;return function(){var n={id:e,this:this,args:arguments};return t._pendingEvent=n,t._resume(),n.result}}}]),t}(),i){t.argv.length<3&&(t.stderr.write("usage: go_js_wasm_exec [wasm binary] [arguments]\n"),t.exit(1));var p=new Go;p.argv=t.argv.slice(2),p.env=Object.assign({TMPDIR:n(305).tmpdir()},Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0})),p.exit=t.exit,WebAssembly.instantiate(fs.readFileSync(t.argv[2]),p.importObject).then((function(e){return t.on("exit",(function(e){0!==e||p.exited||(p._pendingEvent={id:0},p._resume())})),p.run(e.instance)})).catch((function(e){throw e}))}}()}).call(this,n(15),n(6))},202:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=202},206:function(e,t){},208:function(e,t){},218:function(e,t){},220:function(e,t){},245:function(e,t){},247:function(e,t){},248:function(e,t){},253:function(e,t){},255:function(e,t){},262:function(e,t){},264:function(e,t){},282:function(e,t){},284:function(e,t){},296:function(e,t){},299:function(e,t){},364:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n.n(i),r=n(93),o=n.n(r),s=(n(181),n(171)),c=n(30),l=n(11),u=n(10),h=n(3),d=(n(182),n(31)),f=n.n(d),p=n(9),g=n(98),v=n(7),m=n(8);function y(e){return e.map((function(e,t){return[e,t]})).reduce((function(e,t){return t[0]>e[0]?t:e}))[1]}function w(e,t,n){for(var i=[],a=[];t--;)a.push(n);for(;e--;)i.push(a.slice());return i}function b(e){return e[0].map((function(t,n){return e.map((function(e){return e[n]}))}))}function x(e){return new Promise((function(t){return setTimeout(t,e)}))}function S(e,t,n){if(e.current){e.current.width=t*window.devicePixelRatio,e.current.height=n*window.devicePixelRatio;var i=e.current.getContext("2d");i&&i.scale(window.devicePixelRatio,window.devicePixelRatio)}}var T=function(){function e(t){Object(v.a)(this,e),this.gamma=void 0,this.lr=void 0,this.eps=void 0,this.epsDecay=void 0,this.qTable=void 0,this.updateData=void 0,t=Object(l.a)({gamma:.95,lr:.1,eps:.5,epsDecay:.99},t),this.gamma=t.gamma,this.lr=t.lr,this.eps=t.eps,this.epsDecay=t.epsDecay}return Object(m.a)(e,[{key:"prepareForEnv",value:function(e){this.qTable=function(e,t){for(var n=[],i=[];t--;)i.push(0);for(;e--;)n.push(i.slice());return n}(e.stateSpace,e.actionSpace)}},{key:"getAction",value:function(e){var t,n;if(null!=this.qTable)return Math.random()<this.eps?(t=0,n=this.qTable[0].length,Math.floor(Math.random()*(n-t))+t):y(this.qTable[e]);console.error("Q learning agent not prepared")}},{key:"update",value:function(e,t,n,i,a){null!=this.qTable?(this.updateData={state:e,action:t,lr:this.lr,reward:i,done:a,gamma:this.gamma,newState:n,nextAction:y(this.qTable[n]),currentQ:this.qTable[e][t],nextQ:Math.max.apply(Math,Object(g.a)(this.qTable[n]))},this.qTable[e][t]+=this.lr*(i+(a?0:this.gamma*Math.max.apply(Math,Object(g.a)(this.qTable[n])))-this.qTable[e][t])):console.error("Q learning agent not prepared")}},{key:"finishEpisode",value:function(){this.eps*=this.epsDecay}}]),e}(),E=n(17),O=n.n(E),k=O.a.rgb(10,10,10),j=O.a.rgb(110,110,110),D=O.a.rgb(200,200,200),I=(O.a.rgb(224,224,224),O.a.rgb(186,200,146)),_=O.a.rgb(78,201,176),R=O.a.rgb(156,220,254),W=O.a.rgb(86,156,214),A=O.a.rgb(250,138,84),H=O.a.rgb(197,134,192),P=O.a.rgb(220,220,170),C=O.a.rgb(206,145,120),G=O.a.rgb(255,165,0),L={state:H,nextState:W,reward:P,action:C,nextAction:_,currentQ:O.a.rgb(54,36,17),nextQ:O.a.rgb(17,54,31)},M=n(166),N=n.n(M);function U(){var e=Object(h.a)(["\n  color: ",";\n  font-size: ","px;\n"]);return U=function(){return e},e}var F=p.a.div(U(),D.toString(),(function(e){return e.fontSize})),V=function(e){var t=N.a.renderToString(e.expression);return a.a.createElement(F,{fontSize:e.fontSize||20,dangerouslySetInnerHTML:{__html:t}})};function Q(){var e=Object(h.a)(["\textcolor{","}{","}"],["\\textcolor{","}{","}"]);return Q=function(){return e},e}function z(){var e=Object(h.a)(["colorbox{","}{$","$}"],["\\colorbox{","}{$","$}"]);return z=function(){return e},e}var q=function(e,t){return String.raw(z(),e.hex(),t)},B=function(e,t){return String.raw(Q(),e.hex(),t)};function J(){var e=Object(h.a)(["\n        \begin{aligned}"," &leftarrow "," + alpha("," + gamma "," - ",") \\ \n        \n        "," &leftarrow "," + ","("," + "," "," - ",") \\ \n        \n        "," &leftarrow "," + ","("," + "," * "," - ",") \\\n\n        "," &leftarrow ","\n        end{aligned}"],["\n        \\begin{aligned}"," &\\leftarrow "," + \\alpha("," + \\gamma "," - ",") \\\\ \n        \n        "," &\\leftarrow "," + ","("," + "," "," - ",") \\\\ \n        \n        "," &\\leftarrow "," + ","("," + "," * "," - ",") \\\\\n\n        "," &\\leftarrow ","\n        \\end{aligned}"]);return J=function(){return e},e}function K(){var e=Object(h.a)(["Q(",", ",")"]);return K=function(){return e},e}function X(){var e=Object(h.a)(["max_{","}Q(",", ",")"],["\\max_{","}Q(",", ",")"]);return X=function(){return e},e}function Y(){var e=Object(h.a)(["Q(",", ",")"]);return Y=function(){return e},e}function $(){var e=Object(h.a)(["Q(",", ",")"]);return $=function(){return e},e}function Z(){var e=Object(h.a)(["\text{right}"],["\\text{right}"]);return Z=function(){return e},e}function ee(){var e=Object(h.a)(["\text{left}"],["\\text{left}"]);return ee=function(){return e},e}function te(){var e=Object(h.a)(["\text{right}"],["\\text{right}"]);return te=function(){return e},e}function ne(){var e=Object(h.a)(["\text{left}"],["\\text{left}"]);return ne=function(){return e},e}var ie=function(e){var t=e.updateData;if(null==t)return a.a.createElement(a.a.Fragment,null);var n=t.action?String.raw(ne()):String.raw(te()),i=t.nextAction?String.raw(ee()):String.raw(Z()),r=q(L.currentQ,String.raw($(),B(L.state,"s"),B(L.action,"a"))),o=q(L.currentQ,String.raw(Y(),B(L.state,t.state.toString()),B(L.action,n))),s=q(L.nextQ,String.raw(X(),B(L.nextAction,"a'"),B(L.nextState,"s'"),B(L.nextAction,"a'"))),c=q(L.nextQ,String.raw(K(),B(L.nextState,t.newState.toString()),B(L.nextAction,i.toString())));return a.a.createElement("div",{style:{position:"fixed",left:e.position.x,top:e.position.y}},a.a.createElement(V,{expression:String.raw(J(),r,r,B(L.reward,"r"),s,r,o,o,t.lr,B(L.reward,t.reward.toString()),t.gamma,c,o,o,q(L.currentQ,t.currentQ.toFixed(2)),t.lr,B(L.reward,t.reward.toString()),t.gamma,q(L.nextQ,t.nextQ.toFixed(2)),q(L.currentQ,t.currentQ.toFixed(2)),o,(t.currentQ+t.lr*(t.reward+t.gamma*t.nextQ-t.currentQ)).toFixed(2))}))};function ae(){var e=Object(h.a)(["\n  position: fixed;\n  color: white;\n  padding: 4px 8px;\n  border-radius: 4px;\n  cursor: pointer;\n  user-select: none;\n  animation: "," 0.3s ease-out 1;\n"]);return ae=function(){return e},e}function re(){var e=Object(h.a)(["\n    from {\n        background: rgba(255, 255, 255, .5);\n    }\n    to {\n        background: rgba(0, 0, 0, 0);\n    }\n"]);return re=function(){return e},e}var oe=Object(p.b)(re()),se=p.a.div(ae(),oe),ce=a.a.forwardRef((function(e,t){var n=a.a.useRef(null);return a.a.useImperativeHandle(t,(function(){return{click:function(){n.current&&(n.current.style.animation="none",n.current.offsetWidth,n.current.style.animation="")}}})),a.a.createElement(se,{style:{left:e.position.x,top:e.position.y,animation:"none"},onClick:e.onClick,ref:n},a.a.createElement(V,{fontSize:16,expression:e.expression}))})),le=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100;Object(v.a)(this,e),this.n=void 0,this.slip=void 0,this.small=void 0,this.large=void 0,this.episode_length=void 0,this.state=void 0,this.stepCount=void 0,this.stateSpace=void 0,this.actionSpace=void 0,this.n=t,this.slip=n,this.small=i,this.large=a,this.episode_length=r,this.state=0,this.stepCount=0,this.stateSpace=t,this.actionSpace=2}return Object(m.a)(e,[{key:"step",value:function(e){var t=!1;Math.random()<this.slip&&(e=!e,t=!0);var n=0;return e?(n=this.small,this.state=0):this.state<this.n-1?this.state+=1:n=this.large,this.stepCount+=1,console.log(this.stepCount),{newState:this.state,reward:n,done:this.stepCount>=this.episode_length,info:{slipped:t}}}},{key:"reset",value:function(){return this.state=0,this.stepCount=0,this.state}}]),e}(),ue=function(){function e(t,n){Object(v.a)(this,e),this.env=void 0,this.agent=void 0,this.state=void 0,this.prevState=void 0,this.lastReward=void 0,this.totalReward=0,this.lastAction=void 0,this.env=t,this.agent=n,this.reset()}return Object(m.a)(e,[{key:"reset",value:function(){this.state=this.env.reset(),this.prevState=void 0,this.totalReward=0}},{key:"agentTakeAction",value:function(e){var t=this.env.step(e),n=t.newState,i=t.reward,a=t.done,r=t.info;this.lastAction=e,this.lastReward=i,this.totalReward+=i,this.agent.update(this.state,e,n,i,a),this.prevState=this.state,this.state=n;var o=this.totalReward;return a&&(this.agent.finishEpisode(),this.reset()),{action:e,newState:n,reward:i,done:a,totalReward:o,info:r}}},{key:"step",value:function(){var e=this.agent.getAction(this.state);return this.agentTakeAction(e)}}]),e}();var he=n(5),de=function(){function e(t,n,i,a){Object(v.a)(this,e),this.canvas=t,this.ctx=n,this.size=i,this.sceneObjects=a}return Object(m.a)(e,[{key:"render",value:function(){var e=this;requestAnimationFrame(this.render.bind(this)),this.ctx.fillStyle=k,this.ctx.fillRect(0,0,this.size.width,this.size.height),this.sceneObjects.forEach((function(t){t.render(e.ctx,e.size)})),he.a.update()}}]),e}(),fe=function(){function e(t){Object(v.a)(this,e),this.position=void 0,this.redness=void 0,this.position=t,this.redness=0}return Object(m.a)(e,[{key:"move",value:function(e){new he.a.Tween(this.position).to({x:e},150).start()}},{key:"slip",value:function(){this.redness=1,new he.a.Tween(this).to({redness:0},500).start()}},{key:"render",value:function(e){e.fillStyle=R,e.beginPath(),e.arc(this.position.x,this.position.y,20,0,2*Math.PI),e.fill(),e.fillStyle=A.fade(1-this.redness),e.fill()}}]),e}(),pe=function(){function e(t){Object(v.a)(this,e),this.RADIUS=30,this.DIST=100,this.position=t}return Object(m.a)(e,[{key:"highlightStates",value:function(e){this.highlightedStates=e}},{key:"render",value:function(e){var t=this;e.strokeStyle=j,e.lineWidth=1,e.beginPath();for(var n=0;n<5;n++)n<4&&(e.beginPath(),e.moveTo(this.position.x+this.DIST*(n-2)+this.RADIUS,this.position.y),e.lineTo(this.position.x+this.DIST*(n-1)-this.RADIUS,this.position.y)),e.stroke(),e.beginPath(),e.arc(this.position.x+this.DIST*(n-2),this.position.y,this.RADIUS,0,2*Math.PI),e.stroke(),e.font="16px KaTeX_Main",e.fillStyle=j.toString(),e.textAlign="center",e.fillText(n,this.position.x+this.DIST*(n-2),this.position.y+4);this.highlightedStates&&this.highlightedStates.forEach((function(n){e.beginPath(),e.strokeStyle=n.color.toString(),e.arc(t.position.x+t.DIST*(n.index-2),t.position.y,t.RADIUS,0,2*Math.PI),e.stroke(),e.font="16px KaTeX_Main",e.fillStyle=n.color.toString(),e.textAlign="center",e.fillText(n.index,t.position.x+t.DIST*(n.index-2),t.position.y+4)}))}}]),e}(),ge=function(){function e(){Object(v.a)(this,e),this.coins=new Set}return Object(m.a)(e,[{key:"emit",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i={position:e,opacity:{val:0},fading:!1};this.coins.add(i),new he.a.Tween(i.position).delay(n).to(t,200).easing(he.a.Easing.Cubic.Out).start(),new he.a.Tween(i.opacity).delay(n).to({val:.8},200).easing(he.a.Easing.Cubic.Out).start()}},{key:"clear",value:function(){var e=this;this.coins.forEach((function(t){t.fading||(new he.a.Tween(t.opacity).delay(250).to({val:0},400).onComplete((function(){return e.coins.delete(t)})).start(),t.fading=!0)}))}},{key:"render",value:function(e){this.coins.forEach((function(t){e.beginPath(),e.fillStyle=L.reward.fade(1-t.opacity.val).toString(),e.arc(t.position.x,t.position.y,6,0,2*Math.PI),e.fill()}))}}]),e}(),ve=function(){function e(t,n,i){Object(v.a)(this,e),i=Object(l.a)({font:"30px KaTeX_Main",textAlign:"center",precision:2,color:D,modifier:function(e){return e}},i),this.position=t,this.val=n,this.font=i.font,this.textAlign=i.textAlign,this.precision=i.precision,this.modifier=i.modifier,this.color=i.color,this.newVal=0,this.newValColor=A,this.newValOpacity=0,this.newValOffset=0,this.valOpacity=1,this.valOffset=0}return Object(m.a)(e,[{key:"onAnimationFinish",value:function(){this.activeTween=new he.a.Tween(this).to({newValOpacity:0},2e3).start(),this.valOpacity=1,this.valOffset=0,this.val=this.newVal}},{key:"updateVal",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:400;e!==this.newVal&&(this.activeTween&&this.activeTween.stop(),t||(this.val=e,this.newVal=e),e>this.val?(this.val=this.newVal,this.newVal=e,this.newValColor=I,this.valOpacity=1,this.newValOpacity=0,this.valOffset=0,this.newValOffset=-25,this.activeTween=new he.a.Tween(this).to({valOpacity:0,newValOpacity:1,valOffset:25,newValOffset:0},n).onStop(this.onAnimationFinish.bind(this)).onComplete(this.onAnimationFinish.bind(this)).start()):e<this.val&&(this.val=this.newVal,this.newVal=e,this.newValColor=A,this.valOpacity=1,this.newValOpacity=0,this.valOffset=0,this.newValOffset=25,this.activeTween=new he.a.Tween(this).to({valOpacity:0,newValOpacity:1,valOffset:-25,newValOffset:0},n).onStop(this.onAnimationFinish.bind(this)).onComplete(this.onAnimationFinish.bind(this)).start()))}},{key:"render",value:function(e){e.textAlign=this.textAlign,e.font=this.font,e.fillStyle=this.color.fade(1-this.valOpacity),null!=this.val&&e.fillText(this.modifier(this.val.toFixed(this.precision)),this.position.x,this.position.y+this.valOffset),e.fillStyle=this.newValColor.fade(1-this.newValOpacity),null!=this.newVal&&e.fillText(this.modifier(this.newVal.toFixed(this.precision)),this.position.x,this.position.y+this.newValOffset)}}]),e}(),me=function(){function e(t,n){Object(v.a)(this,e),this.CELL_WIDTH=120,this.CELL_HEIGHT=70,this.numberObjects=void 0,this.position=void 0,this.highlightedCells=[],this.position=t,this.numberObjects=[];for(var i=0;i<n.length;i++){for(var a=[],r=0;r<n[0].length;r++)a.push(new ve(0,0,n[i][r]));this.numberObjects.push(a)}}return Object(m.a)(e,[{key:"updateData",value:function(e){for(var t=0;t<this.numberObjects.length;t++)for(var n=0;n<this.numberObjects[0].length;n++)this.numberObjects[t][n].updateVal(e[t][n])}},{key:"highlightCells",value:function(e){this.highlightedCells=e}},{key:"repositionNumbers",value:function(){for(var e=0;e<this.numberObjects.length;e++)for(var t=0;t<this.numberObjects[0].length;t++)this.numberObjects[e][t].position={x:this.position.x+this.CELL_WIDTH*(t+.5),y:this.position.y+45+this.CELL_HEIGHT*e}}},{key:"render",value:function(e){var t=this;e.lineWidth=1,this.repositionNumbers(),this.highlightedCells&&this.highlightedCells.forEach((function(n){e.beginPath(),e.fillStyle=n.color,e.fillRect(t.position.x+t.CELL_WIDTH*n.col,t.position.y+t.CELL_HEIGHT*n.row,t.CELL_WIDTH,t.CELL_HEIGHT)}));for(var n=0;n<this.numberObjects.length;n++)for(var i=0;i<this.numberObjects[0].length;i++)e.beginPath(),e.rect(this.position.x+this.CELL_WIDTH*i,this.position.y+this.CELL_HEIGHT*n,this.CELL_WIDTH,this.CELL_HEIGHT),e.strokeStyle=j.toString(),e.stroke(),this.numberObjects[n][i].render(e)}}]),e}();function ye(){var e="object"===typeof window,t=a.a.useCallback((function(){return{width:e?window.innerWidth:void 0,height:e?window.innerHeight:void 0}}),[e]),n=a.a.useState(t),i=Object(u.a)(n,2),r=i[0],o=i[1];return a.a.useEffect((function(){if(!e)return!1;function n(){o(t())}return window.addEventListener("resize",n),function(){return window.removeEventListener("resize",n)}}),[t,o,e]),r}function we(){var e=Object(h.a)(["\text{left}"],["\\text{left}"]);return we=function(){return e},e}function be(){var e=Object(h.a)(["\text{right}"],["\\text{right}"]);return be=function(){return e},e}function xe(){var e=Object(h.a)(["\n  background-color: ",";\n"]);return xe=function(){return e},e}var Se={gamma:.95,lr:.1,eps:.5,epsDecay:.99},Te=180,Ee=450,Oe=new le,ke=new T(Se);ke.prepareForEnv(Oe);var je=new ue(Oe,ke),De=new ve({x:Ee,y:Te-72},0,{textAlign:"center",font:"40px KaTeX_Main",precision:0}),Ie=new pe({x:Ee,y:Te}),_e=new ge,Re=new fe({x:Ee-2*Ie.DIST,y:Te}),We=new me({x:Ee-2.5*Ie.DIST,y:Te+55},b(ke.qTable));We.CELL_WIDTH=Ie.DIST;var Ae=p.a.div(xe(),k.toString());var He=function(){var e=a.a.useRef(null),t=a.a.useRef(),n=ye(),i=a.a.useState(0),r=Object(u.a)(i,2),o=r[0],s=r[1],c=a.a.useState(Object(l.a)({autoPlay:!1},Se)),h=Object(u.a)(c,2),p=h[0],g=h[1];!function(e){var t=a.a.useState(0),n=Object(u.a)(t,2),i=n[0],r=n[1];a.a.useEffect((function(){window.addEventListener("keypress",(function(t){switch(t.keyCode){case 110:e[i](),i<e.length-1&&r(i+1)}}))}))}([function(){window.alert("hello world")},function(){window.alert("hello world 2")}]);var v=function(e,t,n,i){e?O.current&&O.current.click():E.current&&E.current.click(),i.slipped&&Re.slip(),t&&g(Object(l.a)(Object(l.a)({},p),{},{eps:ke.eps})),s(o+1)},m=function(){var e=je.step(),t=e.action,n=e.done,i=(e.totalReward,e.info);v(t,n,0,i)},y=function(e){if(39===e.keyCode){e.preventDefault();var t=je.agentTakeAction(0),n=t.done,i=(t.totalReward,t.info);v(0,n,0,i)}if(37===e.keyCode){e.preventDefault();var a=je.agentTakeAction(1),r=a.done,o=(a.totalReward,a.info);v(1,r,0,o)}};if(a.a.useEffect((function(){var i=e.current,a=i&&i.getContext("2d");n.width&&n.height&&S(e,n.width,n.height),t.current=new de(i,a,n,[_e,Ie,We,Re,De]),t.current.render()}),[n]),a.a.useEffect((function(){je.reset()}),[]),a.a.useEffect((function(){return document.addEventListener("keydown",y),function(){document.removeEventListener("keydown",y)}})),p.autoPlay&&window.setTimeout(m,200),ke.gamma=p.gamma,ke.lr=p.lr,ke.eps=p.eps,ke.epsDecay=p.epsDecay,n.width&&n.height&&S(e,n.width,n.height),Re.move(Ee+Ie.DIST*((je.state||0)-2)),window.setTimeout((function(){ke.qTable&&We.updateData(b(ke.qTable))}),500),window.setTimeout((function(){De.updateVal(je.totalReward)}),150),_e.clear(),je.lastReward)for(var w=2===je.lastReward?Ee-2*Ie.DIST:Ee+2*Ie.DIST,x=0;x<je.lastReward;x++){var T=2*Math.random()*Math.PI;_e.emit({x:w,y:Te},{x:Ee+40*Math.cos(T),y:Te-85+40*Math.sin(T)},150+10*x)}ke.updateData&&(We.highlightCells([{row:ke.updateData.action,col:ke.updateData.state,color:L.currentQ},{row:ke.updateData.nextAction,col:ke.updateData.newState,color:L.nextQ}]),Ie.highlightStates([{index:ke.updateData.state,color:L.state},{index:ke.updateData.newState,color:L.nextState}]));var E=a.a.useRef(null),O=a.a.useRef(null);return a.a.createElement(Ae,null,a.a.createElement(f.a,{data:p,onUpdate:function(e){g(e)}},a.a.createElement(d.DatNumber,{path:"lr",label:"Learning rate (\u03b1)",min:0,max:1,step:.01}),a.a.createElement(d.DatNumber,{path:"eps",label:"Rnd chance (\u03b5)",min:0,max:1,step:.01}),a.a.createElement(d.DatNumber,{path:"gamma",label:"Discount rate (\u03b3)",min:0,max:1,step:.01}),a.a.createElement(d.DatNumber,{path:"epsDecay",label:"\u03b5 decay",min:0,max:1,step:.01}),a.a.createElement(d.DatBoolean,{path:"autoPlay",label:"Auto-play"}),a.a.createElement(d.DatButton,{label:"Step",onClick:m})),a.a.createElement("canvas",{style:{width:"100%",height:"100%",background:"black"},ref:e}),a.a.createElement(ie,{updateData:ke.updateData,position:{x:Ee-3*We.CELL_WIDTH-12,y:We.position.y+2*We.CELL_HEIGHT+30}}),a.a.createElement(ce,{ref:E,expression:B(ke.updateData&&0===ke.updateData.action?L.action:ke.updateData&&0===ke.updateData.nextAction?L.nextAction:D,String.raw(be())),position:{x:Ee-3*We.CELL_WIDTH-20,y:We.position.y+20},onClick:function(){var e=je.agentTakeAction(0),t=e.done,n=(e.totalReward,e.info);v(0,t,0,n)}}),a.a.createElement(ce,{ref:O,expression:B(ke.updateData&&1===ke.updateData.action?L.action:ke.updateData&&1===ke.updateData.nextAction?L.nextAction:D,String.raw(we())),position:{x:Ee-3*We.CELL_WIDTH-20,y:We.position.y+1*We.CELL_HEIGHT+20},onClick:function(){var e=je.agentTakeAction(1),t=e.done,n=(e.totalReward,e.info);v(1,t,0,n)}}))},Pe=n(16),Ce=n.n(Pe),Ge=n(39),Le=n(169),Me=n.n(Le),Ne=n(12),Ue=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;Object(v.a)(this,e),this.boardSize=void 0,this.foodReward=void 0,this.deathReward=void 0,this.player=void 0,this.food=void 0,this.boardSize=t,this.foodReward=n,this.deathReward=i,this.reset()}return Object(m.a)(e,[{key:"playerOnFood",value:function(){return 2===this.player.gather(this.player.shape[0]).equal(this.food).sum().bufferSync().get(0)}},{key:"playerOutOfBounds",value:function(){var e=this.player.bufferSync(),t=e.get(this.player.shape[0]-1,0),n=e.get(this.player.shape[0]-1,1),i=!(0<=t&&t<this.boardSize&&0<=n&&n<this.boardSize);return i&&console.log("snake went out of bounds"),i}},{key:"collidedWithTail",value:function(){var e=Ne.f(this.player,[this.player.shape[0]-1,1]),t=Object(u.a)(e,2),n=t[0],i=t[1],a=2===Ne.g(n.equal(i),1).max().bufferSync().get(0);return a&&console.log("snake collided with tail"),a}},{key:"step",value:function(e){null==e&&console.log("Error: action was undefined in SnakeEnv!",e);var t=this.player.gather(this.player.shape[0]-1),n=[Ne.h([0,-1]),Ne.h([1,0]),Ne.h([0,1]),Ne.h([-1,0])],i=t.add(n[e]);this.player=this.player.concat(i.reshape([1,2]));var a=0;if(this.playerOnFood())a=this.foodReward,this.randomizeFood();else{var r=Ne.f(this.player,[1,this.player.shape[0]-1]),o=Object(u.a)(r,2)[1];this.player=o}var s=!1;return(this.playerOutOfBounds()||this.collidedWithTail())&&(s=!0,a=this.deathReward),s?{newObservation:Ne.i([this.boardSize,this.boardSize,3]),reward:a,done:s}:{newObservation:this.getObservation(),reward:a,done:s}}},{key:"getObservation",value:function(){var e=this.food.reverse().concat(Ne.h([0])),t=this.player.reverse(1).concat(Ne.a([this.player.shape[0]-1],2).concat(Ne.h([1])).reshape([this.player.shape[0],1]),1),n=e.reshape([1,3]).concat(t),i=Ne.h([1]).concat(Ne.d(1,this.player.shape[0])).concat(Ne.h([1]));return Ne.e(n,i,[this.boardSize,this.boardSize,3])}},{key:"randomizeFood",value:function(){for(;this.food=Ne.c([2],0,this.boardSize,"int32"),2===Ne.g(this.player.equal(this.food),1).max().bufferSync().get(0););}},{key:"reset",value:function(){return this.player=Ne.c([1,2],0,this.boardSize,"int32"),this.randomizeFood(),this.getObservation()}}]),e}(),Fe=n(27);function Ve(){var e=Object(h.a)(["\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  .row {\n    display: flex;\n    justify-content: center;\n    height: 60px;\n  }\n  .cell {\n    width: 60px;\n    height: 100%;\n    &.food {\n      background: ",";\n    }\n    &.snake,\n    &.tail {\n      background: ",";\n    }\n  }\n  @media (max-width: 768px) {\n    width: 100%;\n    .row {\n      height: ","vw;\n    }\n    .cell {\n      width: ","vw;\n    }\n  }\n"]);return Ve=function(){return e},e}var Qe=p.a.div(Ve(),A.desaturate(.3).hex(),I.desaturate(.5).hex(),100/9,100/9),ze=new Ue,qe=ze.getObservation(),Be={stopRunning:!1,disableInput:!1,modelUpdating:!1},Je=function(e){var t=a.a.useState(qe),n=Object(u.a)(t,2),i=n[0],r=n[1],o=a.a.useState(0),s=Object(u.a)(o,2),c=s[0],l=s[1];function h(e,t,n,i,a,r){return d.apply(this,arguments)}function d(){return(d=Object(Ge.a)(Ce.a.mark((function e(t,n,i,a,r,o){var s,c,l,u;return Ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Be.modelUpdating){e.next=2;break}return e.abrupt("return");case 2:return Be.modelUpdating=!0,s=t.predict(n.reshape([1,9,9,3])),c=t.predict(a.reshape([1,9,9,3])),l=r+(o?0:.95*c.max().arraySync()),(u=s.bufferSync()).set(l,0,i),e.next=10,t.fit(n.reshape([1,9,9,3]),u.toTensor(),{epochs:1});case 10:Be.modelUpdating=!1;case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}console.log("Total reward:",c),a.a.useEffect((function(){function e(e){return t.apply(this,arguments)}function t(){return(t=Object(Ge.a)(Ce.a.mark((function e(t){var n,i,a,o,s;return Ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:i=!1,a=void 0,a=0===n?ze.getObservation():ze.reset(),o=Ce.a.mark((function e(){var n,o,s,c,u,d;return Ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Be.stopRunning){e.next=2;break}return e.abrupt("return",{v:void 0});case 2:return n=t.predict(a.reshape([1,9,9,3])),null==(o=n.argMax(1).arraySync()[0])&&(console.log("Error: action was undefined in runModel!",o),console.log("observation:"),a.print(),console.log("prediction:"),n.print(),console.log("argmax:"),console.log(n.argMax(1))),s=ze.step(o),c=s.newObservation,u=s.reward,d=s.done,r(c),l((function(e){return e+u})),e.next=10,h(t,a,o,c,u,i);case 10:return i=d,a=c,e.next=14,x(300);case 14:case"end":return e.stop()}}),e)}));case 5:if(i){e.next=12;break}return e.delegateYield(o(),"t0",7);case 7:if("object"!==typeof(s=e.t0)){e.next=10;break}return e.abrupt("return",s.v);case 10:e.next=5;break;case 12:n++,e.next=1;break;case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var n=Fe.debounce((function(t){Be.stopRunning=!1,Be.disableInput=!1,e(t)}),600);Ne.b("/models/snake/model.json").then((function(t){t.compile({optimizer:"adam",loss:"meanSquaredError"}),e(t),window.addEventListener("keydown",(function(e){if(!Be.disableInput){var i=ze.getObservation(),a={ArrowUp:0,ArrowRight:1,ArrowDown:2,ArrowLeft:3};if(e.key in a){var o=a[e.key],s=ze.step(o),c=s.newObservation,l=s.reward,u=s.done;r(c),Be.stopRunning=!0,h(t,i,o,c,l,u),u&&(Be.disableInput=!0,ze.reset()),n(t)}}}))}))}),[]);var f=i.arraySync();return a.a.createElement(Qe,null,f.map((function(e,t){return a.a.createElement("div",{className:"row",key:t},e.map((function(e,t){var n=1===e[0],i=1===e[1],r=e[2]>0;return a.a.createElement("div",{key:t,className:Me()("cell",{food:n,snake:i,tail:r}),style:{opacity:n?.3:i?.4:r?.1+.3*(e[2]-1)/(ze.player.shape[0]-1):0}})})))})))};function Ke(){var e=Object(h.a)(["\n  display: flex;\n  justify-content: space-between;\n  a {\n    font-weight: 400;\n    color: #666;\n    cursor: pointer;\n    &:hover {\n      color: black;\n    }\n  }\n  span {\n    color: #666;\n  }\n"]);return Ke=function(){return e},e}function Xe(){var e=Object(h.a)(["\n  position: absolute;\n  z-index: -1;\n  width: 100%;\n  height: 100%;\n"]);return Xe=function(){return e},e}function Ye(){var e=Object(h.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  position: fixed;\n  width: 100%;\n  font-family: Quicksand, sans-serif;\n  line-height: 1.3;\n  .bio {\n    max-width: 380px;\n    width: calc(100vw - 48px);\n    padding: 16px;\n    font-size: 18px;\n    margin-bottom: 80px;\n  }\n  .footer {\n    position: absolute;\n    right: 0;\n    bottom: 0;\n    padding: 24px;\n    font-size: 14px;\n    opacity: 0.6;\n    p {\n      margin: 0;\n    }\n  }\n  a {\n    color: black;\n    text-decoration: underline;\n    text-decoration-color: transparent;\n    font-weight: 600;\n    transition: all 0.15s;\n    &:hover {\n      text-decoration-color: black;\n    }\n  }\n"]);return Ye=function(){return e},e}for(var $e=p.a.div(Ye()),Ze=p.a.div(Xe()),et=p.a.div(Ke()),tt=function(e){console.log("props",e);var t={snake:{background:a.a.createElement(Je,null),link:"https://github.com/Xyzrr/rl-snake",name:"DQN playing Snake"}},n=null;if(window.location.hash&&(n=window.location.hash.substr(1)),!n||!(n in t)){var i=Object.keys(t);n=i[Math.floor(Math.random()*i.length)]}var r=t[n];return a.a.createElement($e,null,a.a.createElement(Ze,null,r.background),a.a.createElement("div",{className:"bio"},a.a.createElement("p",null,"Hey, I'm John. "),a.a.createElement("p",null,"I do eng and design, previously at ",a.a.createElement("a",{href:"https://www.adept.ai/"},"Adept"),", ",a.a.createElement("a",{href:"https://wandb.com/"},"Weights & Biases"),", and Google. I like writing concisely and making silky user experiences. Currently working on various AI things."),a.a.createElement("p",null,"If you might like to build something with me, let's meet up. I'm usually in SF."),a.a.createElement(et,null,a.a.createElement("a",{href:"https://projects.johnqian.com"},"Projects"),a.a.createElement("span",null,"\u2219"),a.a.createElement("a",{href:"https://blog.johnqian.com"},"Blog"),a.a.createElement("span",null,"\u2219"),a.a.createElement("a",{href:"/gains"},"Gains"),a.a.createElement("span",null,"\u2219"),a.a.createElement("a",{href:"mailto:johnlongqian+site@gmail.com"},"Contact"))),a.a.createElement("div",{className:"footer"},a.a.createElement("p",null,"Background:"),a.a.createElement("p",null,a.a.createElement("a",{href:r.link},r.name))))},nt=n(21),it=n(65),at=(n(201),n(170)),rt=n.n(at),ot=[[[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,0],[0,1],[1,1],[-2,0],[-2,1]],[[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,0],[0,-1],[1,-1],[-2,0],[-2,-1]]],st=[{color:I,minos:[[[1,2],[1,3],[2,1],[2,2]]],offsets:ot},{color:A,minos:[[[1,1],[1,2],[2,2],[2,3]]],offsets:ot},{color:W,minos:[[[1,1],[2,1],[2,2],[2,3]]],offsets:ot},{color:G,minos:[[[1,3],[2,1],[2,2],[2,3]]],offsets:ot},{color:H,minos:[[[1,2],[2,1],[2,2],[2,3]]],offsets:ot},{color:P,minos:[[[1,2],[1,3],[2,2],[2,3]]],offsets:[[[0,0]],[[1,0]],[[1,-1]],[[0,-1]]]},{color:R,minos:[[[2,1],[2,2],[2,3],[2,4]]],offsets:[[[0,0],[0,-1],[0,2],[0,-1],[0,2]],[[0,-1],[0,0],[0,0],[-1,0],[2,0]],[[-1,-1],[-1,1],[-1,-2],[0,1],[0,-2]],[[-1,0],[-1,0],[-1,0],[1,0],[-2,0]]]}],ct=function(e,t){var n,i=[],a=Object(nt.a)(e);try{for(a.s();!(n=a.n()).done;){var r=n.value;i.push([r[1],t-r[0]-1])}}catch(o){a.e(o)}finally{a.f()}return i},lt=1;lt<8;lt++)for(var ut=st[lt-1],ht=0;ht<3;ht++)ut.minos.push(ct(ut.minos[ht],5));var dt=function(e,t){return st[e-1].minos[t]},ft=rt()((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return st[e-1].color.alpha(t).toString()}),{length:2}),pt=function(){function e(){Object(v.a)(this,e),this.WIDTH_HEIGHT_RATIO=.5,this.GUTTER_WIDTH_RATIO=.2,this.enemies=new Set,this.fullWidth=0,this.fullHeight=0,this.gapWidth=0,this.maxEnemyWidth=void 0,this.grid=[],this.enemyWidth=0,this.animatedEnemyWidth=0,this.yOffset=0}return Object(m.a)(e,[{key:"setMaxEnemyWidth",value:function(e){this.maxEnemyWidth=e}},{key:"setEnemyWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.enemyWidth=e,0===t?this.animatedEnemyWidth=e:new he.a.Tween(this).to({animatedEnemyWidth:e},t).easing(he.a.Easing.Quadratic.InOut).start()}},{key:"getOptimalDimensions",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getSideWidth(),i=0,a=0,r=1;;){var o=(i=n/(r+(r+1)*this.GUTTER_WIDTH_RATIO))/this.WIDTH_HEIGHT_RATIO,s=i*this.GUTTER_WIDTH_RATIO;if((a=Math.floor((this.fullHeight-s)/(o+s)))*r>=Math.ceil(e/2))break;r++}for(var c,l,u,h=0,d=0,f=1;;){var p=(h=this.fullHeight/(f+(f+1)*this.WIDTH_HEIGHT_RATIO*this.GUTTER_WIDTH_RATIO))*this.WIDTH_HEIGHT_RATIO,g=p*this.GUTTER_WIDTH_RATIO;if((d=Math.floor((n-g)/(p+g)))*f>=Math.ceil(e/2))break;f++}var v=h*this.WIDTH_HEIGHT_RATIO;return v>i?(c=v,l=f,u=t?2*Math.ceil(e/f/2):2*d):(c=i,l=t?a:Math.ceil(e/(2*r)),u=2*r),this.maxEnemyWidth&&c>this.maxEnemyWidth&&(c=this.maxEnemyWidth),[c,l,u]}},{key:"reshape",value:function(e){console.log("RESHAPING");var t=this.getOptimalDimensions(e.size),n=Object(u.a)(t,3),i=n[0],a=n[1],r=n[2];this.setEnemyWidth(i),this.grid=w(a,r,null),this.enemies=new Set,this.addNewEnemies(e)}},{key:"getGridCapacity",value:function(){return 0===this.grid.length?0:this.grid.length*this.grid[0].length}},{key:"expand",value:function(e){console.log("EXPANDING");for(var t=this.getOptimalDimensions(e),n=Object(u.a)(t,3),i=n[0],a=n[1],r=n[2],o=w(a,r,null),s=0;s<this.grid.length;s++)for(var c=0;c<this.grid[s].length;c++){var l=(r-this.grid[0].length)/2;o[s][c+l]=this.grid[s][c]}this.setEnemyWidth(i,1001),this.grid=o}},{key:"getGutterWidth",value:function(){return this.enemyWidth*this.GUTTER_WIDTH_RATIO}},{key:"getGridExpectedSideWidth",value:function(){if(0===this.grid.length)return 0;var e=this.grid[0].length/2;e:for(var t=0;t<this.grid[0].length/2;t++){for(var n=0;n<this.grid.length;n++)if(null!=this.grid[n][t]||null!=this.grid[n][this.grid[n].length-1-t])break e;e--}return this.enemyWidth*e+this.getGutterWidth()*(e+1)}},{key:"getGridExpectedHeight",value:function(){var e=this.grid.length;e:for(var t=this.grid.length-1;t>0;t--){for(var n=0;n<this.grid[t].length;n++)if(null!=this.grid[t][n])break e;e--}return this.enemyWidth/this.WIDTH_HEIGHT_RATIO*e+this.getGutterWidth()*(e+1)}},{key:"getSideWidth",value:function(){return(this.fullWidth-this.gapWidth)/2}},{key:"updateYOffset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.getGridExpectedHeight(),n=(this.fullHeight-t)/2;0===e?this.yOffset=n:new he.a.Tween(this).to({yOffset:n},e).easing(he.a.Easing.Quadratic.InOut).start()}},{key:"removeMissingEnemies",value:function(e){for(var t in this.grid)for(var n in this.grid[t]){var i=this.grid[t][n];null==i||e.has(i)||(this.grid[t][n]=null)}}},{key:"addNewEnemies",value:function(e){var t=this.addPath(),n=t.next().value;console.error("ABC attempting with grid",Fe.cloneDeep(this.grid)),console.error("enemies",this.enemies,e);var i,a=Object(nt.a)(e);try{for(a.s();!(i=a.n()).done;){var r=i.value;if(!this.enemies.has(r)){for(;null!=this.grid[n[0]][n[1]];)n=t.next().value,console.error("ABC coord",n);this.grid[n[0]][n[1]]=r}}}catch(o){a.e(o)}finally{a.f()}}},{key:"sidePath",value:Ce.a.mark((function e(t){var n,i,a,r,o;return Ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.grid.length){e.next=2;break}return e.abrupt("return");case 2:n="left"===t?this.grid[0].length/2-1:this.grid[0].length/2,i=0;case 4:if(!(i<Math.max(this.grid.length,this.grid[0].length))){e.next=28;break}if(a=void 0,!((a="left"===t?this.grid[0].length/2-1-i:this.grid[0].length/2+i)>=0&&a<this.grid[0].length)){e.next=16;break}r=0;case 9:if(!(r<i)){e.next=16;break}if(!(r<this.grid.length)){e.next=13;break}return e.next=13,[r,a];case 13:r++,e.next=9;break;case 16:if(!(i<this.grid.length)){e.next=25;break}o=n;case 18:if(!("left"===t?o>=a:o<=a)){e.next=25;break}if(!(o>=0&&o<this.grid[0].length)){e.next=22;break}return e.next=22,[i,o];case 22:o+="left"===t?-1:1,e.next=18;break;case 25:i++,e.next=4;break;case 28:case"end":return e.stop()}}),e,this)}))},{key:"addPath",value:Ce.a.mark((function e(){var t,n,i,a,r;return Ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.sidePath("left"),n=this.sidePath("right"),i=Object(nt.a)(t),e.prev=3,i.s();case 5:if((a=i.n()).done){e.next=13;break}return r=a.value,e.next=9,r;case 9:return e.next=11,n.next().value;case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),i.e(e.t0);case 18:return e.prev=18,i.f(),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[3,15,18,21]])}))},{key:"update",value:function(e,t,n,i){if(console.log("GRID",this.grid),this.gapWidth=i,t!==this.fullWidth||n!==this.fullHeight)return this.fullWidth=t,this.fullHeight=n,this.reshape(e),this.updateYOffset(),void(this.enemies=e);Fe.isEqual(this.enemies,e)||(this.removeMissingEnemies(e),e.size>this.getGridCapacity()&&this.expand(e.size),this.addNewEnemies(e),this.updateYOffset(0===this.enemies.size?0:2e3),this.enemies=e)}},{key:"getEnemyCoordinates",value:function(){for(var e={},t=this.fullWidth/2,n=0;n<this.grid.length;n++)for(var i=0;i<this.grid[n].length;i++){var a=this.grid[n][i];if(null!=a){var r=void 0;if(i>=this.grid[n].length/2){var o=i-this.grid[n].length/2;r=t+this.gapWidth/2+o*this.animatedEnemyWidth+(o+1)*this.getGutterWidth()}else{var s=this.grid[n].length/2-1-i;r=t-this.gapWidth/2-(s+1)*(this.animatedEnemyWidth+this.getGutterWidth())}var c=this.yOffset+n*(this.animatedEnemyWidth/this.WIDTH_HEIGHT_RATIO)+(n+1)*this.getGutterWidth();e[a]=[r,c]}}return[e,this.animatedEnemyWidth]}}]),e}(),gt=function(e,t){return[e[0]+t[0],e[1]+t[1]]},vt=function(e,t){return Object(l.a)(Object(l.a)({},e),{},{position:gt(e.position,t)})},mt=function(e,t){var n,i=dt(e.pieceType,e.orientation),a=Object(nt.a)(i);try{for(a.s();!(n=a.n()).done;){var r=n.value,o=gt(e.position,r);if(o[0]<0||o[0]>=40||o[1]<0||o[1]>=10||t[o[0]][o[1]])return!0}}catch(s){a.e(s)}finally{a.f()}return!1},yt=function(){function e(t){Object(v.a)(this,e),this.ctx=void 0,this.enemyGrid=void 0,this.enemyStates={},this.playerState=null,this.ctx=t,this.enemyGrid=new pt}return Object(m.a)(e,[{key:"getWidth",value:function(){return this.ctx.canvas.width/window.devicePixelRatio}},{key:"getHeight",value:function(){return this.ctx.canvas.height/window.devicePixelRatio}},{key:"renderBorder",value:function(e,t,n,i){var a=10*n,r=20*n;if(this.ctx.strokeStyle="#666",1===i)this.ctx.strokeRect(e-1,t-1,a+2,r+2);else{var o=Math.min(2*i,1),s=t+r/2,c=s-(r/2+1)*o,l=s+(r/2+1)*o,u=Math.max(2*(i-.5),0),h=e+a/2*u,d=e+a-a/2*u;this.ctx.beginPath(),this.ctx.moveTo(e-1,c),this.ctx.lineTo(e-1,l),this.ctx.moveTo(e+a+1,c),this.ctx.lineTo(e+a+1,l),this.ctx.moveTo(e,t-1),this.ctx.lineTo(h,t-1),this.ctx.moveTo(e,t+r+1),this.ctx.lineTo(h,t+r+1),this.ctx.moveTo(e+a,t-1),this.ctx.lineTo(d,t-1),this.ctx.moveTo(e+a,t+r+1),this.ctx.lineTo(d,t+r+1),this.ctx.stroke()}}},{key:"renderGrid",value:function(e,t,n){var i=10*n,a=20*n;this.ctx.strokeStyle="#161616";for(var r=0;r<20;r++)this.ctx.beginPath(),this.ctx.moveTo(e,t+r*n),this.ctx.lineTo(e+i,t+r*n),this.ctx.stroke();for(var o=0;o<10;o++)this.ctx.beginPath(),this.ctx.moveTo(e+o*n,t),this.ctx.lineTo(e+o*n,t+a),this.ctx.stroke()}},{key:"renderActivePiece",value:function(e,t,n,i){var a,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=Object(nt.a)(dt(i.pieceType,i.orientation));try{for(o.s();!(a=o.n()).done;){var s=a.value;this.ctx.fillStyle=r?ft(i.pieceType,.3):ft(i.pieceType);var c=i.position[1]+s[1],l=i.position[0]+s[0]-20;l>=0&&this.ctx.fillRect(e+c*n,t+l*n,n,n)}}catch(u){o.e(u)}finally{o.f()}}},{key:"renderLand",value:function(e,t,n,i){for(var a=20;a<40;a++)for(var r=0;r<10;r++){var o=i[a][r];0!==o&&(this.ctx.fillStyle=ft(o),this.ctx.fillRect(e+n*r,t+n*(a-20),n,n))}}},{key:"renderGameField",value:function(e,t,n,i,a,r){var o=r||{},s=null==o.borderCompleteness?1:o.borderCompleteness,c=null==o.showGrid||o.showGrid,l=null==o.fieldOpacity?1:o.fieldOpacity;if(this.renderBorder(e,t,n,s),c&&this.renderGrid(e,t,n),this.ctx.globalAlpha=l,this.renderLand(e,t,n,i),a){this.renderActivePiece(e,t,n,a);var u=function(e,t){for(var n=0;!mt(vt(e,[n,0]),t);)n++;return vt(e,[n-1,0])}(a,i);this.renderActivePiece(e,t,n,u,!0)}this.ctx.globalAlpha=1}},{key:"renderBagPreview",value:function(e,t,n,i){for(var a=0;a<Math.min(5,i.length);a++){var r=i[a];if("."===r)break;this.ctx.fillStyle=ft(r);var o,s=Object(nt.a)(dt(r,0));try{for(s.s();!(o=s.n()).done;){var c=o.value;this.ctx.fillRect(e+c[1]*n,t+(3*a+c[0])*n,n,n)}}catch(l){s.e(l)}finally{s.f()}}}},{key:"renderHoldSlot",value:function(e,t,n,i,a){if(i){this.ctx.fillStyle=a?j.toString():ft(i);var r,o=Object(nt.a)(dt(i,0));try{for(o.s();!(r=o.n()).done;){var s=r.value;this.ctx.fillRect(e+s[1]*n,t+s[0]*n,n,n)}}catch(c){o.e(c)}finally{o.f()}}}},{key:"renderGameFrame",value:function(e,t,n,i,a){a?(this.renderHoldSlot(e-n-i,t,n,a.hold,a.held),this.renderGameField(e+4*n,t,n,a.field,a.activePiece),this.renderBagPreview(e+14*n+i,t,n,a.nextPieces)):this.renderGrid(e+4*n,t,n)}},{key:"renderSelf",value:function(e){var t=28;22*t>this.getHeight()&&(t=20);var n=19*t+8,i=20*t;return this.renderGameFrame(this.getWidth()/2-n/2,this.getHeight()/2-i/2,t,4,e),n}},{key:"renderEnemy",value:function(e,t,n,i){var a=1,r=1;"joining"===i.animationType&&(a=Math.min(2.5*i.animationProgress,1),r=Math.max(1.67*(i.animationProgress-.4),0)),"disconnecting"===i.animationType&&(a=Math.min(1-2.5*(i.animationProgress-.6),1),r=Math.max(1-1.67*i.animationProgress,0)),this.renderGameField(e,t,n,i.field,i.activePiece,{showGrid:!1,borderCompleteness:a,fieldOpacity:r})}},{key:"renderEnemies",value:function(e){var t=this,n=new Set;for(var i in this.enemyStates)n.add(i);this.enemyGrid.setMaxEnemyWidth(.4*e),this.enemyGrid.update(n,this.getWidth(),this.getHeight(),e);var a=this.enemyGrid.getEnemyCoordinates(),r=Object(u.a)(a,2),o=r[0],s=r[1]/10;Object.entries(o).forEach((function(e){var n=Object(u.a)(e,2),i=n[0],a=n[1],r=t.enemyStates[i];t.renderEnemy(a[0],a[1],s,r)}))}},{key:"renderEverything",value:function(){this.ctx.clearRect(0,0,this.getWidth(),this.getHeight());var e=this.renderSelf(this.playerState);(this.getWidth()-e)/2>80&&this.getHeight()>80&&this.renderEnemies(e)}},{key:"updateFromServer",value:function(e,t){var n=this,i=function(i){if(i!==t)if(null==n.enemyStates[i])n.enemyStates[i]=Object(l.a)(Object(l.a)({},e.playerStates[i]),{},{animationType:"joining",animationProgress:0,tween:null}),n.enemyStates[i].tween=new he.a.Tween(n.enemyStates[i]).to({animationProgress:1},1001).easing(he.a.Easing.Quadratic.Out).onComplete((function(){n.enemyStates[i].animationType=null})).start();else for(var a in e.playerStates[i])n.enemyStates[i][a]=e.playerStates[i][a]};for(var a in e.playerStates)i(a);var r=function(t){var i=n.enemyStates[t];"disconnecting"!==i.animationType&&null==e.playerStates[t]&&(i.animationType="disconnecting",i.animationProgress=0,i.tween&&i.tween.stop(),i.tween=new he.a.Tween(i).to({animationProgress:1},1001).easing(he.a.Easing.Quadratic.Out).onComplete((function(){delete n.enemyStates[t]})).start())};for(var o in this.enemyStates)r(o)}},{key:"updateFromPrediction",value:function(e){this.playerState=e}}]),e}();function wt(){var e=Object(h.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100vh;\n  width: 100vw;\n  flex-wrap: wrap;\n  background: black;\n"]);return wt=function(){return e},e}var bt=37,xt=39,St=38,Tt=90,Et=40,Ot=32,kt=67,jt={},Dt=p.a.div(wt()),It=[];function _t(){return(_t=Object(Ge.a)(Ce.a.mark((function e(){var t,n,i;return Ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Go,console.log("fetching go"),e.next=4,WebAssembly.instantiateStreaming(fetch("main.wasm"),t.importObject);case 4:return n=e.sent,i=n.instance,console.log("finished fetching"),e.next=9,t.run(i);case 9:console.log("go program halted");case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Rt=function(e){return Object(l.a)(Object(l.a)({},e),{},{activePiece:Object(l.a)(Object(l.a)({},e.activePiece),{},{position:[e.activePiece.position.row,e.activePiece.position.col]})})},Wt=function(e){return Object(l.a)(Object(l.a)({},e),{},{activePiece:e.activePiece?Object(l.a)(Object(l.a)({},e.activePiece),{},{position:{row:e.activePiece.position[0],col:e.activePiece.position[1]}}):void 0})},At=function(e){var t=Object(i.useRef)({serverState:{playerStates:{}},predictedStates:[null],inputHistory:[],actionIndex:0,clientID:void 0,frameStartTime:0,serverTimeOffset:0}),n=a.a.useRef(null),r=ye(),o=a.a.useRef(null);return a.a.useEffect((function(){if(null==n.current&&null!=o.current){var e=o.current.getContext("2d");e&&(n.current=new yt(e))}var i=function(e){if(!jt[e.keyCode]){switch(e.keyCode){case bt:s(1);break;case xt:s(2);break;case St:s(3);break;case Tt:s(4);break;case Et:s(5);break;case Ot:s(6);break;case kt:s(7)}jt[e.keyCode]={downTime:Date.now(),lastTriggered:Date.now()}}},a=function(e){delete jt[e.keyCode]};!function(){_t.apply(this,arguments)}();var r=new WebSocket("ws://localhost:8080/socket");r.onopen=function(){r.onmessage=function(e){console.log("got message",e);var r,o=JSON.parse(e.data);if(o.messageType&&"id"===o.messageType)console.log("Got client ID",o.id),t.current.clientID=o.id,t.current.frameStartTime=o.time,t.current.serverTimeOffset=Date.now()-t.current.frameStartTime,window.setTimeout(c,17),window.addEventListener("keydown",i),window.addEventListener("keyup",a);else{var s=o.newState;r=s,s=Object(it.a)(r,(function(e){for(var t=0,n=Object.keys(r.playerStates);t<n.length;t++){var i=n[t];e.playerStates[i]=Rt(r.playerStates[i])}})),function(e,t){if(null==e.clientID)throw new Error("clientID is null when reconciling server state");if(null==t.playerStates)throw new Error("server state is malformed: ".concat(t.playerStates));e.serverState=t;var n=e.serverState.playerStates[e.clientID];if(null!=n){var i=n.time;if((e.frameStartTime-i)%17!==0)throw new Error("frameStartTime ".concat(e.frameStartTime," and server update time ").concat(i," misaligned"));var a=e.predictedStates.length-1-(e.frameStartTime-i)/17;if(a<0)throw new Error("Received server update from before the last update (index ".concat(a,"); predictedStates is probably too short (length ").concat(e.predictedStates.length,")."));if(a>=e.predictedStates.length)console.log("Received server update from the future (index ".concat(a,"); predictedStates is probably lagging behind (length ").concat(e.predictedStates.length,"). Dropping update."));else{if(Fe.isEqual(e.predictedStates[a],n))return console.log("Success: server state matches with client! Slicing predictedStates from index ".concat(a," to ").concat(e.predictedStates.length)),e.predictedStates=e.predictedStates.slice(a),void(e.inputHistory=e.inputHistory.slice(a));console.log("stringified predicted states",JSON.stringify(e.predictedStates)),console.log("Server state",n,"conflicts with client state",JSON.parse(JSON.stringify(e.predictedStates[a])),". Reconciling from index",a,"to",e.predictedStates.length),e.inputHistory=e.inputHistory.slice(a);var r=i;e.predictedStates=[n];var o,s=Object(nt.a)(e.inputHistory);try{for(s.s();!(o=s.n()).done;){var c=o.value;r+=17;var l=e.predictedStates[e.predictedStates.length-1];if(null==l)throw new Error("last predicted state was null while reconciling");if("undefined"!=typeof updateGame){var u=updateGame(JSON.stringify(Wt(l)),JSON.stringify(c),r),h=Rt(JSON.parse(u));e.predictedStates.push(h)}else console.log("updateGame not ready at first reconciliation, pushing duplicated server state for now"),e.predictedStates.push(l)}}catch(d){s.e(d)}finally{s.f()}}}}(t.current,s),n.current&&t.current.clientID&&n.current.updateFromServer(t.current.serverState,t.current.clientID)}}};var s=function(e){var n={time:t.current.frameStartTime,command:e,index:t.current.actionIndex};It.push(n),t.current.actionIndex++;var i=Object(l.a)({playerID:t.current.clientID},n);r.send(JSON.stringify(i))},c=function e(){t.current.frameStartTime+=17,function(e,t){var n=e.predictedStates[e.predictedStates.length-1];if(null==n||"undefined"==typeof updateGame)return e.predictedStates.push(n),void e.inputHistory.push(t);var i=updateGame(JSON.stringify(Wt(n)),JSON.stringify(t),e.frameStartTime.toString()),a=Rt(JSON.parse(i));console.log("inputs",t),e.predictedStates.push(a),e.inputHistory.push(t)}(t.current,It),n.current&&t.current.clientID&&n.current.updateFromPrediction(t.current.predictedStates[t.current.predictedStates.length-1]),It=[];var i=Date.now(),a=jt[xt];a&&i-a.downTime>=117&&i-a.lastTriggered>=22&&(s(2),a.lastTriggered===a.downTime?a.lastTriggered+=117:a.lastTriggered+=22);var r=jt[bt];r&&i-r.downTime>=117&&i-r.lastTriggered>=22&&(s(1),r.lastTriggered===r.downTime?r.lastTriggered+=117:r.lastTriggered+=22);var o=jt[Et];o&&i-o.lastTriggered>=22&&(s(5),o.lastTriggered+=22);var c=t.current.frameStartTime+17-(Date.now()-t.current.serverTimeOffset);window.setTimeout(e,c)};requestAnimationFrame((function e(t){requestAnimationFrame(e),he.a.update(t),n.current&&n.current.renderEverything()}))}),[]),a.a.useEffect((function(){r.width&&r.height&&S(o,r.width,r.height)}),[r]),a.a.createElement(Dt,null,a.a.createElement("canvas",{style:{width:"100%",height:"100%",background:"black"},ref:o}))},Ht=function(e){return console.log("testpageprops",e),a.a.createElement(a.a.Fragment,null,"404 :(")};function Pt(){var e=Object(h.a)(["\n  padding: 16px;\n  font-family: Source Sans Pro;\n  outline: none;\n"]);return Pt=function(){return e},e}var Ct=p.a.div(Pt()),Gt=function(e){e.index;var t=e.block,n=a.a.useRef(null);return a.a.createElement("p",{className:"editor-block",id:t.id,ref:n},t.content)},Lt=function(e){var t=e.block,n="h".concat(t.level);return a.a.createElement(n,{id:t.id},t.content)};function Mt(){return"".concat(Math.floor(1e7*Math.random()))}var Nt=function(){var e=a.a.useState([{type:"header",id:Mt(),level:1,content:"A good day"},{type:"paragraph",id:Mt(),content:"hello"},{type:"paragraph",id:Mt(),content:"another paragraph"}]),t=Object(u.a)(e,2),n=t[0],i=t[1];console.log("STATE",n);var r=a.a.useCallback((function(e){console.log("step 0");var t=window.getSelection();if(null!=t){var a,r,o,s;if(console.log("step 1"),t.anchorNode instanceof Element)a=t.anchorNode;else a=null===(o=t.anchorNode)||void 0===o?void 0:o.parentElement;if(t.focusNode instanceof Element)r=t.focusNode;else r=null===(s=t.focusNode)||void 0===s?void 0:s.parentElement;if(null!=a&&null!=r){console.log("step 2");var c=a.closest(".editor-block"),l=r.closest(".editor-block");if(null!=c&&null!=l&&c===l){console.log("step 3",c,l);var u=c.id,h=Fe.findIndex(n,(function(e){return e.id===u}));return void window.setTimeout((function(){var e=c.innerHTML;i((function(t){return Object(it.b)(t,(function(t){t[h].content=function(e){return null==e?"":e}(e)}))}))}))}}}e.preventDefault()}),[n]);return a.a.createElement(Ct,{contentEditable:!0,onKeyDown:r,suppressContentEditableWarning:!0,onPaste:function(e){console.group("Pasted:");for(var t=e.clipboardData.items,n=function(n){var i=t[n],a={data:e.clipboardData.getData(i.type),asFile:i.getAsFile(),asEntry:i.webkitGetAsEntry()};i.getAsString((function(e){a.asString=e})),console.group("".concat(i.type," (").concat(i.kind,")")),console.log(a),console.groupEnd()},i=0;i<t.length;i++)n(i);console.groupEnd()}},n.map((function(e,t){var n;switch(e.type){case"header":n=Lt;break;case"paragraph":n=Gt}return a.a.createElement(n,{index:t,block:e,key:e.id})})))},Ut=function(){return a.a.createElement(Nt,null)};function Ft(){var e=Object(h.a)(["\n  padding: 16px;\n  font-family: Source Sans Pro;\n  outline: none;\n  border: none;\n  width: 100%;\n  min-height: 100vh;\n"]);return Ft=function(){return e},e}var Vt=p.a.textarea(Ft()),Qt=function(){return a.a.createElement(Vt,{placeholder:"Paste anything here!",onPaste:function(e){console.group("Pasted:");for(var t=e.clipboardData.items,n=function(n){var i=t[n],a={data:e.clipboardData.getData(i.type),asFile:i.getAsFile(),asEntry:i.webkitGetAsEntry()};i.getAsString((function(e){a.asString=e})),console.group("".concat(i.type," (").concat(i.kind,")")),console.log(a),console.groupEnd()},i=0;i<t.length;i++)n(i);console.groupEnd()}})};function zt(){var e=Object(h.a)(["\n  transition: filter 0.4s;\n  filter: grayscale(100%);\n  &:hover {\n    filter: grayscale(0%);\n  }\n"]);return zt=function(){return e},e}function qt(){var e=Object(h.a)(["\n  margin-top: 8px;\n  margin-left: -16px;\n  margin-right: -16px;\n  font-family: Quicksand;\n  text-align: center;\n"]);return qt=function(){return e},e}function Bt(){var e=Object(h.a)(["\n  display: flex;\n  align-items: center;\n  flex-direction: column;\n  width: 160px;\n  video {\n    width: 160px;\n    height: 160px;\n    object-fit: cover;\n    border-radius: 4px;\n    background: #f2f2f2;\n  }\n\n  @media (max-width: 768px) {\n    width: 108px;\n    video {\n      width: 108px;\n      height: 108px;\n    }\n  }\n"]);return Bt=function(){return e},e}function Jt(){var e=Object(h.a)(["\n  display: flex;\n  gap: 48px;\n  width: min(700px, 100vw - 48px);\n  margin: 0 auto;\n  flex-wrap: wrap;\n  justify-content: center;\n"]);return Jt=function(){return e},e}function Kt(){var e=Object(h.a)(["\n  h1 {\n    font-family: Quicksand;\n    text-align: center;\n    margin-top: 64px;\n    margin-bottom: 64px;\n  }\n"]);return Kt=function(){return e},e}var Xt=p.a.div(Kt()),Yt=p.a.div(Jt()),$t=p.a.div(Bt()),Zt=p.a.div(qt()),en=p.a.video(zt()),tn=function(e){var t=e.src,n=e.thumbnailTime,i=a.a.useRef(null);return a.a.useEffect((function(){i.current&&(i.current.currentTime=n||0,i.current.pause())}),[]),a.a.createElement(en,{ref:i,src:t,autoPlay:!0,playsInline:!0,onTouchStart:function(e){e.currentTarget.currentTime=0,e.currentTarget.play()},onTouchEnd:function(e){e.currentTarget.currentTime=n||0,e.currentTarget.pause()},onMouseEnter:function(e){e.currentTarget.currentTime=0;try{e.currentTarget.play()}catch(t){}},onMouseLeave:function(e){e.currentTarget.currentTime=n||0;try{e.currentTarget.pause()}catch(t){}}})},nn=[{title:"10 muscle ups",src:"https://storage.googleapis.com/john-gains/10%20muscle%20ups.mp4",thumbnailTime:5},{title:"1 one arm pullup",src:"https://storage.googleapis.com/john-gains/one%20arm%20pullup.mp4",thumbnailTime:7.8},{title:"Tuck front lever",src:"https://storage.googleapis.com/john-gains/tuck%20front%20lever.mov",thumbnailTime:6},{title:"5 pistol squats",src:"https://storage.googleapis.com/john-gains/5%20pistol%20squats.mp4",thumbnailTime:8}],an=function(e){return a.a.createElement(Xt,null,a.a.createElement("h1",null,"Progress"),a.a.createElement(Yt,null,nn.map((function(e){return a.a.createElement($t,null,a.a.createElement(tn,{src:e.src,thumbnailTime:e.thumbnailTime}),a.a.createElement(Zt,null,e.title))}))))};var rn=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(s.a,null,a.a.createElement(c.c,null,a.a.createElement(c.a,{path:"/tetris",exact:!0,component:At}),a.a.createElement(c.a,{path:"/qlearning",exact:!0,component:He}),a.a.createElement(c.a,{path:"/text",exact:!0,component:Ut}),a.a.createElement(c.a,{path:"/clipboard",exact:!0,component:Qt}),a.a.createElement(c.a,{path:"/gains",exact:!0,component:an}),a.a.createElement(c.a,{path:"/",exact:!0,component:tt}),a.a.createElement(c.a,{component:Ht}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(rn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[176,1,2]]]);
//# sourceMappingURL=main.b535c9b1.chunk.js.map